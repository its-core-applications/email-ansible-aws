---

- name: "Set egress.{{ subd }}"
  delegate_to: localhost
  become: false
  run_once: true
  route53:
    command: "create"
    overwrite: true
    zone: "{{ subd }}"
    record: "egress.{{ subd }}"
    type: "A"
    ttl: 60
    value: "{{ groups.tag_Class_egress | default({}) | map('extract', hostvars, 'ec2_private_ip_address') | join(', ') }}"
  when: groups.tag_Class_egress is defined

