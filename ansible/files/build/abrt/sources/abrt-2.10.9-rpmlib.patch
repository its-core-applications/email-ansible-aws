From 83dfda00f01ae56895c6724736ed72e2b79fe1d8 Mon Sep 17 00:00:00 2001
From: Paul Arthur <paul.arthur@flowerysong.com>
Date: Wed, 16 May 2018 21:51:14 -0400
Subject: [PATCH] Revert "Quick hack to fix build with rpm >= 4.14"

This reverts commit 2de6090ad2db2d865b630d713a8bf21b650fafae.
---
 src/daemon/rpm.c | 7 -------
 1 file changed, 7 deletions(-)

diff --git a/src/daemon/rpm.c b/src/daemon/rpm.c
index af9a7be4..06a15c66 100644
--- a/src/daemon/rpm.c
+++ b/src/daemon/rpm.c
@@ -76,14 +76,11 @@ void rpm_destroy()
     rpmFreeMacros(NULL);
     rpmFreeRpmrc();
 
-/* rpm >= 4.14 handles this automatically on exit */
-#if 0
     /* RPM doc says "clean up any open iterators and databases".
      * Observed to eliminate these Berkeley DB warnings:
      * "BDB2053 Freeing read locks for locker 0x1e0: 28718/139661746636736"
      */
     rpmdbCheckTerminate(1);
-#endif
 #endif
 
     list_free_with_free(list_fingerprints);
@@ -103,11 +100,7 @@ void rpm_load_gpgkey(const char* filename)
     }
 
     uint8_t keyID[8];
-#if 0
     if (pgpPubkeyFingerprint(pkt, pklen, keyID) == 0)
-#else
-    if (pgpPubkeyKeyID(pkt, pklen, keyID) == 0)
-#endif
     {
         char *fingerprint = pgpHexStr(keyID, sizeof(keyID));
         if (fingerprint != NULL)
-- 
2.14.3

