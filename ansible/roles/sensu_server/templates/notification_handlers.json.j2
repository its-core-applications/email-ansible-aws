{
  "filters": {
    "production": {
      "negate": true,
      "attributes": {
        "client": {
          "subscriptions": "eval: value.include?'Status_development'"
        }
      }
    },
    "critical": {
      "negate": false,
      "attributes": {
        "check": {
          "history": "eval: value.include?'2'"
        }
      }
    },
    "state_change_only": {
      "negate": false,
      "attributes": {
        "occurrences": "eval: value == 1 || ':::action:::' == 'resolve'"
      }
    }
  },
  "handlers": {
    "page": {
      "type": "pipe",
      "command": "handler-sns -r {{ aws_region }} -t oncall",
      "filters": [ "occurrences", "production", "critical" ]
    },
    "email": {
      "type": "pipe",
      "command": "handler-sns -r {{ aws_region }} -t rootmail",
      "filters": [ "occurrences" ]
    },
    "fyi": {
      "type": "pipe",
      "command": "handler-sns -r {{ aws_region }} -t rootmail",
      "filters": [ "state_change_only" ]
    },
    "graphite": {
      "type": "tcp",
      "timeout": 30,
      "socket": {
        "host": "127.0.0.1",
        "port": 2003
      },
      "mutator": "only_check_output"
    },
    "default": {
      "type": "set",
      "handlers": [
        "page",
        "email"
      ]
    }
  }
}
