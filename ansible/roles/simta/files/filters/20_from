#!/bin/dash
# deny based on envelope from

dnsbl=deny-from.dnsbl

if check_env \$SIMTA_SMTP_MAIL_FROM; then
    from=$(echo -n $SIMTA_SMTP_MAIL_FROM | tr A-Z a-z | sha1sum)
    from=${from%% *}
    if ! simrbl -q -t -l $dnsbl $from; then
	log "20_from: $dnsbl lists $SIMTA_SMTP_MAIL_FROM ($from)"
	filter_exit ${MESSAGE_REJECT}
    fi
fi

