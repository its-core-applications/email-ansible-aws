---

- name: Install extra packages
  yum:
    name: "{{ item }}"
    state: latest
  with_items:
    - gitolite3
    - nfs-utils
    - opendkim
    - openldap-clients
    - unzip

- name: Install extra pip packages
  pip: name={{ item }} state=latest
  with_items:
    - hvac

- include: task_find_subnets.yml

- name: Create filesystem for /home
  filesystem:
    dev: /dev/xvdd
    fstype: xfs
    force: no

- name: Mount /home
  mount:
    name: /home
    src: /dev/xvdd
    fstype: xfs
    state: mounted

- name: Configure .bashrc
  copy:
    dest: /home/ec2-user/.bashrc
    src: bashrc
    owner: ec2-user
    group: ec2-user
    mode: 0644

