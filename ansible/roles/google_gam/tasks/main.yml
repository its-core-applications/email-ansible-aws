---

- tags:
    - google
    - collab_admin_kit
  block:
    - name: Install extra python packages
      pip:
        name:
          - google-auth

    - name: Install GAM
      become_user: collaborate
      git:
        repo: https://github.com/jay0lee/GAM.git
        dest: ~/GAM
        version: 7112a42

    - name: Install gam script
      template:
        dest: /usr/bin/gam
        src: gam.sh.j2
        owner: root
        group: root
        mode: "0755"

    - name: Install gam-discussions script
      template:
        dest: /usr/bin/gam-discussions
        src: gam-discussions.sh.j2
        owner: root
        group: root
        mode: "0755"

    - name: Set up gam alias
      copy:
        dest: /etc/profile.d/99_gam.sh
        src: 99_gam.sh
        owner: root
        group: root
        mode: "0644"

