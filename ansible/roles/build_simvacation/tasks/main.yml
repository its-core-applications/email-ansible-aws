---

- meta: flush_handlers

- name: Install build dependencies
  yum: pkg={{ item }} state=present
  with_items:
    - openldap-devel
    - urcl-devel

- name: Update the simvacation source tree
  become: false
  git: repo=git://scm.marwnad.com/umich/simvacation.git dest=~/simvacation update=yes force=yes

- name: Build simvacation RPM (autoreconf)
  become: false
  command: chdir=~/simvacation autoreconf -fiv

- name: Build simvacation RPM (configure)
  become: false
  command: chdir=~/simvacation ./configure

- name: Build simvacation RPM (make rpm)
  become: false
  command: chdir=~/simvacation make rpm
  notify: Update yum repository
