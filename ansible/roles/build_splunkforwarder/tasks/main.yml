---

- name: Download Splunk RPM
  get_url:
    url: "https://www.splunk.com/bin/splunk/DownloadActivityServlet?architecture=x86_64&platform=linux&version={{ splunk_version }}&product=universalforwarder&filename={{ splunk_rpm }}&wget=true"
    dest: "/var/tmp/{{ splunk_rpm }}"
    checksum: "{{ splunk_checksum }}"

- name: Upload Splunk RPM
  s3:
    bucket: "{{ yum_hostname }}"
    region: "{{ yum_aws_region }}"
    mode: put
    permission: public-read
    object: "{{ ansible_distribution | lower }}/{{ ansible_distribution_major_version }}/{{ splunk_rpm }}"
    src: "/var/tmp/{{ splunk_rpm }}"
    overwrite: never
