---

- name: Install comint
  yum:
    name: "{{ item }}"
    state: latest
  with_items:
    - comint

- name: Create directories
  file:
    dest: "{{ item }}"
    state: directory
    owner: collaborate
    group: nonpeople
    mode: 0775
  with_items:
    - /usr/local/collaboration
    - /usr/local/collaboration/dispatch
    - /usr/local/collaboration/dispatch/local
    - /usr/local/collaboration/nag
    - /usr/local/collaboration/nag/local
    - /usr/local/collaboration/report
    - /usr/local/collaboration/report/local

- name: Set up monitoring skeleton
  template:
    dest: "/usr/local/collaboration/{{ item }}"
    src: "{{ item }}.j2"
    owner: collaborate
    group: nonpeople
    mode: 0664
  with_items:
    - comint.conf
    - dispatch/dispatch.conf
    - nag/nag.conf
    - report/report.conf

