---

- name: Create certificate storage directory
  file:
    dest: /etc/pki/collab/private
    owner: root
    group: mail
    mode: 0750
    state: directory
  when: certificate_type != 'null'

- name: "{{ certificate }} : Install private key"
  template:
    dest: "/etc/pki/collab/private/{{ certificate }}.key"
    src: key.j2
    owner: root
    group: mail
    mode: 0640
  when: certificate_type != 'null'

- name: "{{ certificate }} : Install certificate"
  copy:
    dest: "/etc/pki/collab/private/{{ certificate }}.crt"
    src: "{{ certificate }}.crt"
    owner: root
    group: mail
    mode: 0644
  when: certificate_type == 'tls'
