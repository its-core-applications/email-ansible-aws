- tags:
    - odm
  block:
    - name: Install ODM
      pip:
        name: git+https://github.com/flowerysong/ODM.git
        state: latest

    - name: Install quickxorhash
      yum:
        name: quickxorhash
        state: latest

    - name: Configure ODM
      template:
        dest: /etc/odm.yaml
        src: odm.yaml.j2
        owner: root
        group: root
        mode: "0644"

    - name: Copy utility scripts
      copy:
        src: "{{ item }}"
        dest: /usr/local/bin/{{ item }}
        owner: root
        group: root
        mode: "0755"
      loop:
        - odm-download
        - odm-incremental
        - launch-odm-download
        - launch-odm-incremental
