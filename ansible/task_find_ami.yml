---

- name: Get AMI data
  ec2_ami_facts:
    region: "{{ aws_region }}"
    owners: self
    filters:
      "tag:os": amzn2
      "tag:image_type": "{{ launch_class | default('base') }}"
  register: find_ami_facts

- name: Find latest AMI
  set_fact:
    find_ami: "{{ find_ami_facts.images | sort(attribute='creation_date') | last }}"

