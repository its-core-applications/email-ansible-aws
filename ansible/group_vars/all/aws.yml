---

tld: "{{ lookup( 'env', 'TLD' ) }}"
subd: "{{ [( aws_status == 'prod' ) | ternary('a', 'x'), 'mail', tld ] | join('.') }}"

aws_region: "{{ lookup('env', 'AWS_DEFAULT_REGION') }}"
aws_region_group: "{{ groups['region_' ~ aws_region | replace('-', '_')] | default([]) }}"
aws_status: "{{ lookup('env', 'AWS_STATUS') }}"
aws_resource_prefix: umcollab
aws_resource_owner: its iso cs cs
aws_primary_regions:
  prod: us-west-2
  nonprod: us-east-2
aws_primary_region: "{{ aws_primary_regions[aws_status] }}"
aws_region_vdc_core: us-east-2

aws_profiles:
  prod:
    efs: vdc-prod
    s3: umcollab
    sns: umcollab
    spfd: umcollab
    subd: umcollab
    us-east-2: vdc-prod
    us-west-2: umcollab
    vdc-core: vdc-core
  nonprod:
    efs: vdc-nonprod
    s3: vdc-nonprod
    sns: vdc-nonprod
    spfd: vdc-nonprod
    subd: vdc-nonprod
    us-east-2: vdc-nonprod
    vdc-core: vdc-core-nonprod

aws_profile: "{{ aws_profiles[aws_status][aws_region] }}"
aws_profile_ec2: "{{ aws_profiles[aws_status][region] }}"
aws_profile_s3: "{{ aws_profiles[aws_status].s3 }}"
aws_profile_subd: "{{ aws_profiles[aws_status].subd }}"
aws_profile_spfd: "{{ aws_profiles[aws_status].spfd }}"
aws_profile_sns: "{{ aws_profiles[aws_status].sns }}"
aws_profile_efs: "{{ aws_profiles[aws_status].efs }}"

vdc_core: false

sns_region: "{{ lookup('env', 'SNS_REGION') }}"
efs_region: us-east-2
ec2sg_region: "{{ aws_region }}"
yum_aws_region: us-west-2

aws_instance_default:
  prod: m5.large
  nonprod: t3.small

aws_region_layout:
  prod:
    us-east-2:
      ctools-mx:
        size: t3.small
      dnsbl:
        count: 3
        size: c5n.large
      egress:
        count: 3
        size: m5.2xlarge
      jail:
        size: t3.large
      master:
        autocycle: false
      mx:
        count: 6
        cycle_method: spinup
        size: m5.xlarge
      relay-egress:
        count: 3
      syslog:
        autocycle: false
      vdc-relay:
        count: 2
        size: t3.small
    us-west-2:
      builder:
        autokill: true
        autocycle: false
      dev:
        autokill: true
        autocycle: false
      dnsbl:
        count: 3
        size: c5n.large
      egress:
        count: 3
        size: m5.2xlarge
      master:
        autocycle: false
      mx:
        count: 6
        cycle_method: spinup
        size: m5.xlarge
      mx-test:
        size: t3.small
      syslog:
        autocycle: false
  nonprod:
    us-east-2:
      authn-relay: {}
      authz-relay: {}
      authz-static: {}
      builder:
        autokill: true
        autocycle: false
        size: t3.large
      ctools-mx: {}
      dev:
        autokill: true
        autocycle: false
      dnsbl: {}
      egress:
        count: 2
      jail: {}
      master:
        autocycle: false
        size: t3.large
      mx:
        count: 3
        cycle_method: spinup
      relay-egress: {}
      syslog: {}
      vdc-relay: {}

yum_hostname: yum.{{ subd }}
yum_repo_path: "{{ ansible_facts.distribution | lower }}/{{ ansible_facts.distribution_major_version }}"

master_hostname: "{{ master_hostnames[aws_status][aws_region] }}.{{ subd }}"

master_hostnames:
  nonprod:
    us-east-2: pandora
  prod:
    us-west-2: mogo
    us-east-2: ego

rbldnsd_master:
  - 141.211.21.71
  - 141.211.7.108

trusted_external_ips:
  - 141.211.12.0/24
  - 141.211.125.0/24

ops_email: blackops@{{ tld }}
ops_rootmail: blackops.{{ (aws_status == 'prod') | ternary('root', 'nonprod') }}@{{ tld }}

